From PR #1754
