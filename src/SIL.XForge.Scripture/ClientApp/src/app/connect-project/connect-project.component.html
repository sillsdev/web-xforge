<ng-container *transloco="let t; read: 'connect_project'">
  <div class="title mat-display-1">{{ t("my_projects") }}</div>
  <div class="content" [ngSwitch]="state">
    <div *ngSwitchCase="'login'" class="paratext-login-container">
      <div>{{ t("you_must_be_logged_in_to_paratext") }}</div>
      <button mat-flat-button id="paratext-login-button" type="button" (click)="logInWithParatext()">
        <img src="/assets/images/logo-pt9.png" alt="Paratext Logo" class="paratext-logo" />{{
          t("log_in_with_paratext")
        }}
      </button>
    </div>
    <mat-card *ngSwitchCase="'connecting'" class="progress-container card-outline">
      <div class="progress-label">{{ t("connecting_to_project", { projectName: connectProjectName }) }}</div>
      <app-sync-progress [projectDoc]="projectDoc" (inProgress)="updateStatus($event)"></app-sync-progress>
    </mat-card>

    <ng-container *ngSwitchDefault>
      <ng-container *ngIf="state !== 'configuring'">
        <ng-container *ngIf="projects.length > 0 || state === 'offline'; else noProjectMsg">
          <mat-selection-list [multiple]="false" #projectsConnectedList>
            <mat-list-option
              *ngFor="let project of projectDocs$ | async"
              [value]="project.data"
              (selectedChange)="goToProject(projectsConnectedList)"
            >
              {{ projectLabel(project.data) }}
            </mat-list-option>
          </mat-selection-list>
        </ng-container>

        <span *ngIf="!isAppOnline"> {{ t("connect_network_to_connect_project") }} </span>

        <ng-container *ngIf="projectsUnconnected.length > 0; else noProjectsConnectableMsg">
          <span class="new-project-header"> {{ t("connect_to_new_project") }} </span>
          <mat-selection-list [multiple]="false" #projectsUnconnectedList>
            <mat-list-option
              [value]="project.paratextId"
              *ngFor="let project of projectsUnconnected"
              [disabled]="!project.isConnectable"
              (selectedChange)="switchToNewProjectState()"
            >
              {{ projectLabel(project) }}
              <ng-container *ngIf="!project.isConnectable">&nbsp;**</ng-container>
            </mat-list-option>
          </mat-selection-list>

          <p *ngIf="hasNonAdministratorProject" id="connect-non-admin-msg">
            {{ t("only_paratext_admins_can_start") }}
          </p>
        </ng-container>
      </ng-container>

      <app-new-project
        *ngIf="state === 'configuring'"
        [targetProject]="getTargetProject()"
        [projects]="projects"
      ></app-new-project>

      <ng-template #noProjectMsg>
        <p
          *ngIf="state !== 'loading'"
          id="no-projects-msg"
          [innerHtml]="i18n.translateAndInsertTags('connect_project.no_connected_projects')"
        ></p>
      </ng-template>
      <ng-template #noProjectsConnectableMsg>
        <p
          *ngIf="state !== 'loading'"
          id="no-projects-connectable-msg"
          [innerHtml]="i18n.translateAndInsertTags('connect_project.no_connectable_projects')"
        ></p>
      </ng-template>
    </ng-container>
  </div>
</ng-container>
