From PR #1753
